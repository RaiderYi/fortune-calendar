# -*- coding: utf-8 -*-
"""
节气相关常量
包含24节气名称、日期表、季节映射等
"""

# 24节气名称（从小寒开始，按时间顺序）
SOLAR_TERMS = [
    "小寒", "大寒",     # 丑月
    "立春", "雨水",     # 寅月
    "惊蛰", "春分",     # 卯月
    "清明", "谷雨",     # 辰月
    "立夏", "小满",     # 巳月
    "芒种", "夏至",     # 午月
    "小暑", "大暑",     # 未月
    "立秋", "处暑",     # 申月
    "白露", "秋分",     # 酉月
    "寒露", "霜降",     # 戌月
    "立冬", "小雪",     # 亥月
    "大雪", "冬至"      # 子月
]

# 节气索引到月支索引的映射
# 每两个节气对应一个月
# 小寒大寒->丑(1), 立春雨水->寅(2), ...
TERM_INDEX_TO_MONTH_ZHI = {
    0: 1, 1: 1,     # 小寒大寒 -> 丑
    2: 2, 3: 2,     # 立春雨水 -> 寅
    4: 3, 5: 3,     # 惊蛰春分 -> 卯
    6: 4, 7: 4,     # 清明谷雨 -> 辰
    8: 5, 9: 5,     # 立夏小满 -> 巳
    10: 6, 11: 6,   # 芒种夏至 -> 午
    12: 7, 13: 7,   # 小暑大暑 -> 未
    14: 8, 15: 8,   # 立秋处暑 -> 申
    16: 9, 17: 9,   # 白露秋分 -> 酉
    18: 10, 19: 10, # 寒露霜降 -> 戌
    20: 11, 21: 11, # 立冬小雪 -> 亥
    22: 0, 23: 0    # 大雪冬至 -> 子
}

# 月令季节映射
MONTH_ZHI_SEASON = {
    "寅": "春", "卯": "春", "辰": "四季",
    "巳": "夏", "午": "夏", "未": "四季",
    "申": "秋", "酉": "秋", "戌": "四季",
    "亥": "冬", "子": "冬", "丑": "四季"
}

# 月令五行当令
YUE_LING_DANG_LING = {
    "寅": "木", "卯": "木", "辰": "土",
    "巳": "火", "午": "火", "未": "土",
    "申": "金", "酉": "金", "戌": "土",
    "亥": "水", "子": "水", "丑": "土"
}

# 节气日期表（2020-2030年）
# 格式：{年份: [(月, 日), ...]} 共24个节气
SOLAR_TERM_TABLE = {
    2020: [
        (1, 6), (1, 20), (2, 4), (2, 19), (3, 5), (3, 20),
        (4, 4), (4, 19), (5, 5), (5, 20), (6, 5), (6, 21),
        (7, 6), (7, 22), (8, 7), (8, 22), (9, 7), (9, 22),
        (10, 8), (10, 23), (11, 7), (11, 22), (12, 7), (12, 21)
    ],
    2021: [
        (1, 5), (1, 20), (2, 3), (2, 18), (3, 5), (3, 20),
        (4, 4), (4, 20), (5, 5), (5, 21), (6, 5), (6, 21),
        (7, 7), (7, 22), (8, 7), (8, 23), (9, 7), (9, 23),
        (10, 8), (10, 23), (11, 7), (11, 22), (12, 7), (12, 21)
    ],
    2022: [
        (1, 5), (1, 20), (2, 4), (2, 19), (3, 5), (3, 20),
        (4, 5), (4, 20), (5, 5), (5, 21), (6, 6), (6, 21),
        (7, 7), (7, 23), (8, 7), (8, 23), (9, 7), (9, 23),
        (10, 8), (10, 23), (11, 7), (11, 22), (12, 7), (12, 22)
    ],
    2023: [
        (1, 5), (1, 20), (2, 4), (2, 19), (3, 6), (3, 21),
        (4, 5), (4, 20), (5, 6), (5, 21), (6, 6), (6, 21),
        (7, 7), (7, 23), (8, 8), (8, 23), (9, 8), (9, 23),
        (10, 8), (10, 24), (11, 8), (11, 22), (12, 7), (12, 22)
    ],
    2024: [
        (1, 6), (1, 20), (2, 4), (2, 19), (3, 5), (3, 20),
        (4, 4), (4, 19), (5, 5), (5, 20), (6, 5), (6, 21),
        (7, 6), (7, 22), (8, 7), (8, 22), (9, 7), (9, 22),
        (10, 8), (10, 23), (11, 7), (11, 22), (12, 6), (12, 21)
    ],
    2025: [
        (1, 5), (1, 20), (2, 3), (2, 18), (3, 5), (3, 20),
        (4, 4), (4, 20), (5, 5), (5, 21), (6, 5), (6, 21),
        (7, 7), (7, 22), (8, 7), (8, 23), (9, 7), (9, 23),
        (10, 8), (10, 23), (11, 7), (11, 22), (12, 7), (12, 21)
    ],
    2026: [
        (1, 5), (1, 20), (2, 4), (2, 18), (3, 5), (3, 20),
        (4, 5), (4, 20), (5, 5), (5, 21), (6, 5), (6, 21),
        (7, 7), (7, 23), (8, 7), (8, 23), (9, 7), (9, 23),
        (10, 8), (10, 23), (11, 7), (11, 22), (12, 7), (12, 22)
    ],
    2027: [
        (1, 5), (1, 20), (2, 4), (2, 19), (3, 6), (3, 21),
        (4, 5), (4, 20), (5, 6), (5, 21), (6, 6), (6, 21),
        (7, 7), (7, 23), (8, 8), (8, 23), (9, 8), (9, 23),
        (10, 9), (10, 24), (11, 8), (11, 22), (12, 7), (12, 22)
    ],
    2028: [
        (1, 6), (1, 21), (2, 4), (2, 19), (3, 5), (3, 20),
        (4, 4), (4, 19), (5, 5), (5, 20), (6, 5), (6, 21),
        (7, 6), (7, 22), (8, 7), (8, 22), (9, 7), (9, 22),
        (10, 8), (10, 23), (11, 7), (11, 22), (12, 6), (12, 21)
    ],
    2029: [
        (1, 5), (1, 20), (2, 3), (2, 18), (3, 5), (3, 20),
        (4, 4), (4, 20), (5, 5), (5, 21), (6, 5), (6, 21),
        (7, 7), (7, 22), (8, 7), (8, 23), (9, 7), (9, 23),
        (10, 8), (10, 23), (11, 7), (11, 22), (12, 7), (12, 21)
    ],
    2030: [
        (1, 5), (1, 20), (2, 4), (2, 19), (3, 6), (3, 20),
        (4, 5), (4, 20), (5, 5), (5, 21), (6, 6), (6, 21),
        (7, 7), (7, 23), (8, 7), (8, 23), (9, 8), (9, 23),
        (10, 8), (10, 23), (11, 8), (11, 22), (12, 7), (12, 22)
    ]
}

# 默认节气日期（用于没有精确数据的年份）
DEFAULT_TERM_DATES = [
    (1, 6), (1, 20), (2, 4), (2, 19), (3, 6), (3, 21),
    (4, 5), (4, 20), (5, 6), (5, 21), (6, 6), (6, 21),
    (7, 7), (7, 23), (8, 7), (8, 23), (9, 8), (9, 23),
    (10, 8), (10, 23), (11, 7), (11, 22), (12, 7), (12, 22)
]


def get_term_name(index: int) -> str:
    """根据索引获取节气名称"""
    return SOLAR_TERMS[index % 24]


def get_term_index(name: str) -> int:
    """根据节气名称获取索引"""
    return SOLAR_TERMS.index(name) if name in SOLAR_TERMS else -1


def get_month_zhi_index_from_term(term_index: int) -> int:
    """根据节气索引获取月支索引"""
    return TERM_INDEX_TO_MONTH_ZHI.get(term_index % 24, 0)


def get_season_from_month_zhi(month_zhi: str) -> str:
    """根据月支获取季节"""
    return MONTH_ZHI_SEASON.get(month_zhi, "未知")


def get_dang_ling_element(month_zhi: str) -> str:
    """获取月令当令五行"""
    return YUE_LING_DANG_LING.get(month_zhi)
