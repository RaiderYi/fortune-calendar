# -*- coding: utf-8 -*-
"""
天干相关常量
包含天干列表、五行属性、阴阳属性等核心数据
"""

# 十天干（按序）
TIAN_GAN = ["甲", "乙", "丙", "丁", "戊", "己", "庚", "辛", "壬", "癸"]

# 天干对应五行
TIAN_GAN_WUXING = {
    "甲": "木", "乙": "木",
    "丙": "火", "丁": "火",
    "戊": "土", "己": "土",
    "庚": "金", "辛": "金",
    "壬": "水", "癸": "水"
}

# 天干阴阳属性 (1=阳干, 0=阴干)
# 阳干：甲丙戊庚壬
# 阴干：乙丁己辛癸
TIAN_GAN_YINYANG = {
    "甲": 1, "乙": 0,
    "丙": 1, "丁": 0,
    "戊": 1, "己": 0,
    "庚": 1, "辛": 0,
    "壬": 1, "癸": 0
}

# 天干五合
# 甲己合化土，乙庚合化金，丙辛合化水，丁壬合化木，戊癸合化火
TIAN_GAN_WU_HE = {
    ("甲", "己"): "土",
    ("乙", "庚"): "金",
    ("丙", "辛"): "水",
    ("丁", "壬"): "木",
    ("戊", "癸"): "火"
}

# 五虎遁元（年干起月干）
# 甲己之年丙作首（正月起丙寅）
# 乙庚之年戊为头（正月起戊寅）
# 丙辛之岁寻庚上（正月起庚寅）
# 丁壬壬寅顺水流（正月起壬寅）
# 戊癸之年何处起（正月起甲寅）
WU_HU_DUN = {
    "甲": 2,  # 丙
    "己": 2,
    "乙": 4,  # 戊
    "庚": 4,
    "丙": 6,  # 庚
    "辛": 6,
    "丁": 8,  # 壬
    "壬": 8,
    "戊": 0,  # 甲
    "癸": 0
}

# 五鼠遁元（日干起时干）
# 甲己还加甲（子时起甲子）
# 乙庚丙作初（子时起丙子）
# 丙辛从戊起（子时起戊子）
# 丁壬庚子居（子时起庚子）
# 戊癸何方发（子时起壬子）
WU_SHU_DUN = {
    "甲": 0,  # 甲
    "己": 0,
    "乙": 2,  # 丙
    "庚": 2,
    "丙": 4,  # 戊
    "辛": 4,
    "丁": 6,  # 庚
    "壬": 6,
    "戊": 8,  # 壬
    "癸": 8
}


def get_tiangan_index(gan: str) -> int:
    """获取天干索引"""
    return TIAN_GAN.index(gan)


def get_tiangan_by_index(index: int) -> str:
    """根据索引获取天干"""
    return TIAN_GAN[index % 10]


def get_tiangan_wuxing(gan: str) -> str:
    """获取天干的五行属性"""
    return TIAN_GAN_WUXING.get(gan)


def is_yang_gan(gan: str) -> bool:
    """判断是否为阳干"""
    return TIAN_GAN_YINYANG.get(gan) == 1


def is_same_yinyang(gan1: str, gan2: str) -> bool:
    """判断两个天干是否同阴阳"""
    return TIAN_GAN_YINYANG.get(gan1) == TIAN_GAN_YINYANG.get(gan2)
